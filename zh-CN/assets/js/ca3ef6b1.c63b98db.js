"use strict";(globalThis.webpackChunkalova_website=globalThis.webpackChunkalova_website||[]).push([[2624],{28453(e,n,s){s.d(n,{R:()=>c,x:()=>i});var r=s(96540);const o={},l=r.createContext(o);function c(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),r.createElement(l.Provider,{value:n},e.children)}},31805(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"api/wormhole","title":"wormhole API","description":"@alova/wormhole \u662f\u4e13\u4e3a alova \u5e93\u63d0\u4f9b\u7684\u66f4\u73b0\u4ee3\u5316\u7684 OpenAPI \u751f\u6210\u65b9\u6848\uff0c\u5b83\u53ef\u4ee5\u540c\u65f6\u751f\u6210 API \u51fd\u6570\u3001\u5b8c\u6574\u7684 API \u7c7b\u578b\uff0c\u548c\u5b8c\u6574\u7684 API \u6587\u6863\uff0calova \u7684\u5f00\u53d1\u5de5\u5177\u53ef\u4ee5\u4e3a\u4f60\u6d88\u9664\u4e2d\u95f4\u7684 API \u6587\u6863\uff0c\u50cf\u866b\u6d1e\u4e00\u6837\u62c9\u8fd1\u524d\u540e\u7aef\u7684\u534f\u4f5c\u8ddd\u79bb\uff0c\u5b83\u4e5f\u662f\u4f5c\u4e3a vscode \u6269\u5c55\u7684\u5e95\u5c42\u5b9e\u73b0\u3002","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/api/07-wormhole.md","sourceDirName":"api","slug":"/api/wormhole","permalink":"/zh-CN/api/wormhole","draft":false,"unlisted":false,"editUrl":"https://github.com/alovajs/alovajs.github.io/blob/main/docs/api/07-wormhole.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"title":"wormhole API"},"sidebar":"api","previous":{"title":"\u5168\u5c40\u914d\u7f6e","permalink":"/zh-CN/api/global-config"}}');var o=s(74848),l=s(28453);const c={title:"wormhole API"},i=void 0,d={},a=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"Commands",id:"commands",level:2},{value:"gen",id:"gen",level:3},{value:"init",id:"init",level:3},{value:"Node API",id:"node-api",level:2},{value:"createConfig()",id:"createconfig",level:3},{value:"resolveWorkspaces()",id:"resolveworkspaces",level:3},{value:"readConfig()",id:"readconfig",level:3},{value:"generate()",id:"generate",level:3}];function t(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"@alova/wormhole"})," \u662f\u4e13\u4e3a alova \u5e93\u63d0\u4f9b\u7684\u66f4\u73b0\u4ee3\u5316\u7684 OpenAPI \u751f\u6210\u65b9\u6848\uff0c\u5b83\u53ef\u4ee5\u540c\u65f6\u751f\u6210 API \u51fd\u6570\u3001\u5b8c\u6574\u7684 API \u7c7b\u578b\uff0c\u548c\u5b8c\u6574\u7684 API \u6587\u6863\uff0calova \u7684\u5f00\u53d1\u5de5\u5177\u53ef\u4ee5\u4e3a\u4f60\u6d88\u9664\u4e2d\u95f4\u7684 API \u6587\u6863\uff0c\u50cf\u866b\u6d1e\u4e00\u6837\u62c9\u8fd1\u524d\u540e\u7aef\u7684\u534f\u4f5c\u8ddd\u79bb\uff0c\u5b83\u4e5f\u662f\u4f5c\u4e3a vscode \u6269\u5c55\u7684\u5e95\u5c42\u5b9e\u73b0\u3002"]}),"\n",(0,o.jsx)(n.h2,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# npm\nnpm i @alova/wormhole --save-dev\n# yarn\nyarn add @alova/wormhole --dev\n# pnpm\npnpm add @alova/wormhole -D\n"})}),"\n",(0,o.jsxs)(n.admonition,{title:"\u6269\u5c55\u5b89\u88c5\u63d0\u793a",type:"info",children:[(0,o.jsxs)(n.p,{children:["\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528 vscode\uff0c\u5f3a\u70c8\u5efa\u8bae\u4f60\u5c06",(0,o.jsx)(n.code,{children:"@alova/wormhole"}),"\u914d\u5408 alova \u7684 vscode \u6269\u5c55\u4e00\u8d77\u4f7f\u7528\uff0c\u5b89\u88c5 vscode \u6269\u5c55\uff0c\u8bf7\u53c2\u8003",(0,o.jsx)(n.a,{href:"/tutorial/getting-started/openapi-integration",children:"OpenAPI\u96c6\u6210"}),"\u3002"]}),(0,o.jsxs)(n.p,{children:["\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528\u5176\u4ed6\u7f16\u8f91\u5668\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7",(0,o.jsx)(n.code,{children:"@alova/wormhole"}),"\u7684\u547d\u4ee4\u6765\u751f\u6210\u5b8c\u6574\u7684 API \u4fe1\u606f\u3002"]})]}),"\n",(0,o.jsx)(n.h2,{id:"commands",children:"Commands"}),"\n",(0,o.jsx)(n.h3,{id:"gen",children:"gen"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"alova gen [-f, --force] [-c --cwd <path>] [-w --workspace]\n"})}),"\n",(0,o.jsxs)(n.p,{children:["gen \u5c06\u4f1a\u67e5\u627e",(0,o.jsx)(n.code,{children:"alova.config.{cjs,js,mjs,ts}"}),"\u914d\u7f6e\u6587\u4ef6\u5e76\u4f7f\u7528\u5b83\u81ea\u52a8\u751f\u6210 API \u76f8\u5173\u4fe1\u606f\u3002"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"\u53c2\u6570\uff1a"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"-f, --force"}),"\uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5c06\u4f1a\u68c0\u67e5\u6700\u65b0\u7684 OpenAPI \u6587\u4ef6\u662f\u5426\u6709\u66f4\u65b0\uff0c\u6307\u5b9a\u6b64\u53c2\u6570\u540e\u5c06\u4f1a\u5ffd\u7565\u68c0\u67e5\uff0c\u5e76\u5f3a\u5236\u91cd\u65b0\u751f\u6210\u3002"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"-c, --cwd <path>"}),"\uff1a\u6307\u5b9a\u8981\u751f\u6210\u7684\u914d\u7f6e\u6587\u4ef6\u7684\u5de5\u4f5c\u76ee\u5f55\uff0c\u9ed8\u8ba4\u4e3a\u5f53\u524d\u76ee\u5f55\u3002"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"-w, --workspace"}),"\uff1a\u6307\u5b9a\u662f\u5426\u4ee5 workspace \u7684\u65b9\u5f0f\u751f\u6210\uff0c\u5b83\u5c06\u4f1a\u6839\u636e",(0,o.jsx)(n.code,{children:"package.json"}),"\u4e2d\u7684",(0,o.jsx)(n.code,{children:"workspaces"}),"\uff0c\u6216",(0,o.jsx)(n.code,{children:"pnpm-workspace.yaml"}),"\u4e2d\u5b9a\u4e49\u7684\u5b50\u5305\u6765\u67e5\u627e\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u751f\u6210\u6240\u6709\u5b50\u5305\u7684 API \u76f8\u5173\u4fe1\u606f\u3002"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"init",children:"init"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"alova init [-t, --type <type>] [-c --cwd <path>]\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210 alova.config \u914d\u7f6e\u6587\u4ef6\uff0c\u5b83\u5c06\u4f1a\u6839\u636e\u9879\u76ee\u7c7b\u578b\u81ea\u52a8\u751f\u6210\u4e0d\u540c\u540e\u7f00\u7684\u914d\u7f6e\u6587\u4ef6\u3002"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"\u53c2\u6570\uff1a"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"-t, --type"}),"\uff1a\u6307\u5b9a\u8981\u751f\u6210\u7684\u914d\u7f6e\u6587\u4ef6\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u6709\uff1a",(0,o.jsx)(n.code,{children:"auto/ts/typescript/module/commonjs"}),"\uff0c\u9ed8\u8ba4\u4e3a",(0,o.jsx)(n.code,{children:"auto"}),"\uff0c\u5b83\u5c06\u6839\u636e\u9879\u76ee\u7c7b\u578b\u81ea\u52a8\u751f\u6210\u4e0d\u540c\u540e\u7f00\u7684\u914d\u7f6e\u6587\u4ef6\u3002"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"-c, --cwd <path>"}),"\uff1a\u6307\u5b9a\u8981\u751f\u6210\u7684\u914d\u7f6e\u6587\u4ef6\u7684\u5de5\u4f5c\u76ee\u5f55\uff0c\u9ed8\u8ba4\u4e3a\u5f53\u524d\u76ee\u5f55\u3002"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"node-api",children:"Node API"}),"\n",(0,o.jsx)(n.h3,{id:"createconfig",children:"createConfig()"}),"\n",(0,o.jsx)(n.p,{children:"\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\u3002"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u7c7b\u578b"})}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"type TemplateType = 'typescript' | 'module' | 'commonjs';\ninterface ConfigCreationOptions {\n  projectPath?: string;\n  type?: TemplateType;\n}\ndeclare function createConfig(options?: ConfigCreationOptions): Promise<void>;\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u53c2\u6570"})}),"\n"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"projectPath"}),"\uff1a\u9879\u76ee\u8def\u5f84\uff0c\u9ed8\u8ba4\u4e3a",(0,o.jsx)(n.code,{children:"process.cwd()"}),"\u3002"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"type"}),"\uff1a\u914d\u7f6e\u6587\u4ef6\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u4e3a",(0,o.jsx)(n.code,{children:"typescript"}),"\u3001",(0,o.jsx)(n.code,{children:"module"}),"\u3001",(0,o.jsx)(n.code,{children:"commonjs"}),"\u3002"]}),"\n"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u793a\u4f8b"})}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import { createConfig } from '@alova/wormhole';\n\nawait createConfig();\n"})}),"\n",(0,o.jsx)(n.h3,{id:"resolveworkspaces",children:"resolveWorkspaces()"}),"\n",(0,o.jsxs)(n.p,{children:["\u67e5\u627e monorepo \u9879\u76ee\u4e0b\u6240\u6709\u5305\u542b alova.config \u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u5b83\u5c06\u4f1a\u6839\u636e",(0,o.jsx)(n.code,{children:"package.json"}),"\u4e2d\u7684",(0,o.jsx)(n.code,{children:"workspaces"}),"\uff0c\u6216",(0,o.jsx)(n.code,{children:"pnpm-workspace.yaml"}),"\u4e2d\u5b9a\u4e49\u7684\u5b50\u5305\u6765\u67e5\u627e\u914d\u7f6e\u6587\u4ef6"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"declare function resolveWorkspaces(projectPath?: string): Promise<string[]>;\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u53c2\u6570"})}),"\n"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"projectPath"}),": \u67e5\u627e\u7684\u9879\u76ee\u8def\u5f84\uff0c\u9ed8\u8ba4\u4e3a",(0,o.jsx)(n.code,{children:"process.cwd()"}),"\u3002"]}),"\n"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u8fd4\u56de\u503c"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"\u5305\u542b alova.config \u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55\u76f8\u5bf9\u8def\u5f84\u7684\u6570\u7ec4\u3002"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u793a\u4f8b"})}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import { resolveWorkspaces } from '@alova/wormhole';\nconst workspaces = await resolveWorkspaces();\n"})}),"\n",(0,o.jsx)(n.h3,{id:"readconfig",children:"readConfig()"}),"\n",(0,o.jsx)(n.p,{children:"\u8bfb\u53d6 alova.config \u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u8fd4\u56de\u89e3\u6790\u540e\u7684\u914d\u7f6e\u5bf9\u8c61\u3002"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"declare function readConfig(projectPath?: string): Promise<Config>;\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u53c2\u6570"})}),"\n"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"projectPath"}),": \u914d\u7f6e\u6587\u4ef6\u6240\u5728\u7684\u9879\u76ee\u8def\u5f84\uff0c\u9ed8\u8ba4\u4e3a",(0,o.jsx)(n.code,{children:"process.cwd()"}),"\u3002"]}),"\n"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u8fd4\u56de\u503c"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"\u914d\u7f6e\u5bf9\u8c61\u3002"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import { generate } from '@alova/wormhole';\nconst config = await readConfig();\n"})}),"\n",(0,o.jsx)(n.h3,{id:"generate",children:"generate()"}),"\n",(0,o.jsxs)(n.p,{children:["\u6839\u636e\u914d\u7f6e\u5bf9\u8c61\u751f\u6210\u76f8\u5173 API \u4fe1\u606f\uff0c\u4e00\u822c\u9700\u8981\u4e0e ",(0,o.jsx)(n.code,{children:"readConfig()"})," \u4e00\u8d77\u4f7f\u7528\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"type GenerateApiOptions = {\n  force?: boolean;\n  projectPath?: string;\n};\ndeclare function generate(config: Config, rules?: GenerateApiOptions): Promise<boolean[]>;\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u53c2\u6570"})}),"\n"]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"config"}),": \u914d\u7f6e\u5bf9\u8c61\uff0c\u5b83\u4e00\u822c\u901a\u8fc7",(0,o.jsx)(n.code,{children:"readConfig"}),"\u51fd\u6570\u8bfb\u53d6\u3002"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"rules"}),": \u751f\u6210\u89c4\u5219\uff0c\u53ef\u9009\u53c2\u6570\u6709\uff1a","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"force"}),": \u662f\u5426\u5f3a\u5236\u91cd\u65b0\u751f\u6210\uff0c\u9ed8\u8ba4\u4e3a",(0,o.jsx)(n.code,{children:"false"}),"\u3002"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"projectPath"}),": \u9879\u76ee\u8def\u5f84\uff0c\u9ed8\u8ba4\u4e3a",(0,o.jsx)(n.code,{children:"process.cwd()"}),"\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u8fd4\u56de\u503c"})}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u5143\u7d20\u5305\u542b config \u4e2d\u7684",(0,o.jsx)(n.code,{children:"generator"}),"\u9879\u662f\u5426\u751f\u6210\u6210\u529f\u3002"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u793a\u4f8b 1"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"\u914d\u7f6e\u6587\u4ef6\u53ea\u5b58\u5728\u4e8e\u6839\u76ee\u5f55\u4e0b\u3002"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import { readConfig, generate } from '@alova/wormhole';\n\nconst config = await readConfig();\nconst results = await generate(config);\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.strong,{children:"\u793a\u4f8b 2"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"\u914d\u7f6e\u6587\u4ef6\u5b58\u5728\u4e8e\u591a\u4e2a\u5b50\u5305\u4e2d\uff08monorepo\uff09\u3002"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import { readConfig, generate, resolveWorkspaces } from '@alova/wormhole';\n\nconst workspaces = await resolveWorkspaces();\nfor (const workspace of workspaces) {\n  const config = await readConfig(workspace);\n  await generate(config);\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(t,{...e})}):t(e)}}}]);