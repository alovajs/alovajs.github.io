"use strict";(self.webpackChunkalova_website=self.webpackChunkalova_website||[]).push([[363],{50082:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>c,toc:()=>h});var a=n(85893),s=n(11151);const i={title:"Method Matcher"},o=void 0,c={id:"tutorial/client/in-depth/method-matcher",title:"Method Matcher",description:"Fully",source:"@site/docs/tutorial/03-client/02-in-depth/02-method-matcher.md",sourceDirName:"tutorial/03-client/02-in-depth",slug:"/tutorial/client/in-depth/method-matcher",permalink:"/tutorial/client/in-depth/method-matcher",draft:!1,unlisted:!1,editUrl:"https://github.com/alovajs/alovajs.github.io/blob/main/docs/tutorial/03-client/02-in-depth/02-method-matcher.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Method Matcher"},sidebar:"tutorial",previous:{title:"Update states across components",permalink:"/tutorial/client/in-depth/update-across-components"},next:{title:"Request Middleware",permalink:"/tutorial/client/in-depth/middleware"}},r={},h=[{value:"Matching rules",id:"matching-rules",level:2},{value:"Matching by name property",id:"matching-by-name-property",level:2},{value:"Match by regular expression",id:"match-by-regular-expression",level:2},{value:"Filter matching results",id:"filter-matching-results",level:2},{value:"Match a single method instance",id:"match-a-single-method-instance",level:2},{value:"Limit instance snapshots",id:"limit-instance-snapshots",level:2}];function l(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.admonition,{title:"Usage scope",type:"info",children:(0,a.jsx)(t.p,{children:"Fully"})}),"\n",(0,a.jsx)(t.p,{children:"The method snapshot matcher is a method that dynamically searches for method instances in the requested method snapshot list. Each alova instance has an independent snapshot space. It is generally used when developers are not sure which method to use. The method snapshot matcher can be used to search according to certain rules."}),"\n",(0,a.jsx)(t.p,{children:"It is generally used with the following 5 functions that need to use method instances."}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"/tutorial/cache/set-and-query",children:"setCache"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"/tutorial/cache/set-and-query",children:"queryCache"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"/tutorial/cache/manually-invalidate",children:"invalidateCache"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"/tutorial/client/in-depth/update-across-components",children:"updateState"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"/tutorial/client/strategy/use-fetcher",children:"useFetcher.fetch"})}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"matching-rules",children:"Matching rules"}),"\n",(0,a.jsxs)(t.p,{children:["When a method instance is requested, it will be saved as a snapshot. The method snapshot matcher searches for the method snapshots based on the ",(0,a.jsx)(t.code,{children:"name"})," property set by the method instance. Multiple matchers are allowed to set the same ",(0,a.jsx)(t.code,{children:"name"}),"."]}),"\n",(0,a.jsx)(t.h2,{id:"matching-by-name-property",children:"Matching by name property"}),"\n",(0,a.jsx)(t.p,{children:"Match by passing in the full instance name. By default, a matching array is returned."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"// Each time getTodoList is called, a new method instance is generated, and their names are the same\nconst getTodoList = currentPage =>\n  alova.Get('/todo/list', {\n    name: 'todoList'\n    // ...\n  });\n\n// Match all Method instances with the name `todoList`\nconst matchedMethods = alova.snapshots.match('todoList');\n"})}),"\n",(0,a.jsx)(t.h2,{id:"match-by-regular-expression",children:"Match by regular expression"}),"\n",(0,a.jsx)(t.p,{children:"By passing in a regular expression for matching, all method instance names that match the regular expression will be matched, and the result is also an array."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"// Match all Method instances whose name starts with `todo`\nconst matchedMethods = alova.snapshots.match(/^todo/);\n"})}),"\n",(0,a.jsx)(t.h2,{id:"filter-matching-results",children:"Filter matching results"}),"\n",(0,a.jsxs)(t.p,{children:["By specifying ",(0,a.jsx)(t.code,{children:"filter"}),", you can further filter method instances that do not meet the conditions. The filter function is used in the same way as Array.prototype.filter. Return true to indicate a successful match and false to indicate a failure. See the type declaration above for details."]}),"\n",(0,a.jsx)(t.p,{children:"Let's look at a few examples."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"Invalidate the cache of the last method instance of a specific name"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-javascript",children:"const matchedMethods = alova.snapshots.match({\n  name: 'todoList',\n  filter: (method, index, methods) => index === methods.length - 1\n});\n"})}),"\n",(0,a.jsx)(t.h2,{id:"match-a-single-method-instance",children:"Match a single method instance"}),"\n",(0,a.jsxs)(t.p,{children:["You can also set the second function of the ",(0,a.jsx)(t.code,{children:"match"})," function to ",(0,a.jsx)(t.code,{children:"false"})," to return the first item of the matching result, and return ",(0,a.jsx)(t.code,{children:"undefined"})," if no match is found."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"const matchedSingleMethod = alova.snapshots.match(/^todo/, false);\n"})}),"\n",(0,a.jsx)(t.h2,{id:"limit-instance-snapshots",children:"Limit instance snapshots"}),"\n",(0,a.jsx)(t.p,{children:"By default, 1000 method instance snapshots are saved, otherwise frequent requests may cause memory overflow. You can also adjust the limit as needed."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"import { globalConfig } from 'alova';\n\nconst alovaInstance = createAlova({\n  // ...\n  // Limit to 500 instance snapshots\n  snapshots: 500\n});\n"})}),"\n",(0,a.jsx)(t.p,{children:"When set to 0, instance snapshots will no longer be saved, and the method snapshot matcher will not be used."})]})}function d(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},11151:(e,t,n)=>{n.d(t,{Z:()=>c,a:()=>o});var a=n(67294);const s={},i=a.createContext(s);function o(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);