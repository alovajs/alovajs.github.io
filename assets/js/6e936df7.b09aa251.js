"use strict";(globalThis.webpackChunkalova_website=globalThis.webpackChunkalova_website||[]).push([[711],{11470(e,n,l){l.d(n,{A:()=>I});var i=l(96540),s=l(34164),t=l(17559),a=l(23104),r=l(56347),d=l(205),o=l(57485),c=l(31682),p=l(70679);function h(e){return i.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function u(e){const{values:n,children:l}=e;return(0,i.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:l,default:i}})=>({value:e,label:n,attributes:l,default:i}))}(l);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,l])}function f({value:e,tabValues:n}){return n.some(n=>n.value===e)}function j({queryString:e=!1,groupId:n}){const l=(0,r.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,o.aZ)(s),(0,i.useCallback)(e=>{if(!s)return;const n=new URLSearchParams(l.location.search);n.set(s,e),l.replace({...l.location,search:n.toString()})},[s,l])]}function m(e){const{defaultValue:n,queryString:l=!1,groupId:s}=e,t=u(e),[a,r]=(0,i.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!f({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const l=n.find(e=>e.default)??n[0];if(!l)throw new Error("Unexpected error: 0 tabValues");return l.value}({defaultValue:n,tabValues:t})),[o,c]=j({queryString:l,groupId:s}),[h,m]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[l,s]=(0,p.Dv)(n);return[l,(0,i.useCallback)(e=>{n&&s.set(e)},[n,s])]}({groupId:s}),x=(()=>{const e=o??h;return f({value:e,tabValues:t})?e:null})();(0,d.A)(()=>{x&&r(x)},[x]);return{selectedValue:a,selectValue:(0,i.useCallback)(e=>{if(!f({value:e,tabValues:t}))throw new Error(`Can't select invalid tab value=${e}`);r(e),c(e),m(e)},[c,m,t]),tabValues:t}}var x=l(92303);const g="tabList__CuJ",b="tabItem_LNqP";var v=l(74848);function y({className:e,block:n,selectedValue:l,selectValue:i,tabValues:t}){const r=[],{blockElementScrollPositionUntilNextRender:d}=(0,a.a_)(),o=e=>{const n=e.currentTarget,s=r.indexOf(n),a=t[s].value;a!==l&&(d(n),i(a))},c=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const l=r.indexOf(e.currentTarget)+1;n=r[l]??r[0];break}case"ArrowLeft":{const l=r.indexOf(e.currentTarget)-1;n=r[l]??r[r.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:t.map(({value:e,label:n,attributes:i})=>(0,v.jsx)("li",{role:"tab",tabIndex:l===e?0:-1,"aria-selected":l===e,ref:e=>{r.push(e)},onKeyDown:c,onClick:o,...i,className:(0,s.A)("tabs__item",b,i?.className,{"tabs__item--active":l===e}),children:n??e},e))})}function w({lazy:e,children:n,selectedValue:l}){const t=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=t.find(e=>e.props.value===l);return e?(0,i.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:t.map((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==l}))})}function F(e){const n=m(e);return(0,v.jsxs)("div",{className:(0,s.A)(t.G.tabs.container,"tabs-container",g),children:[(0,v.jsx)(y,{...n,...e}),(0,v.jsx)(w,{...n,...e})]})}function I(e){const n=(0,x.A)();return(0,v.jsx)(F,{...e,children:h(e.children)},String(n))}},19365(e,n,l){l.d(n,{A:()=>a});l(96540);var i=l(34164);const s="tabItem_Ymn6";var t=l(74848);function a({children:e,hidden:n,className:l}){return(0,t.jsx)("div",{role:"tabpanel",className:(0,i.A)(s,l),hidden:n,children:e})}},28453(e,n,l){l.d(n,{R:()=>a,x:()=>r});var i=l(96540);const s={},t=i.createContext(s);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(t.Provider,{value:n},e.children)}},54517(e,n,l){l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>d,metadata:()=>i,toc:()=>p});const i=JSON.parse('{"id":"tutorial/client/strategy/use-uploader","title":"Unified upload strategy","description":"use hook","source":"@site/docs/tutorial/03-client/01-strategy/16-use-uploader.md","sourceDirName":"tutorial/03-client/01-strategy","slug":"/tutorial/client/strategy/use-uploader","permalink":"/tutorial/client/strategy/use-uploader","draft":false,"unlisted":false,"editUrl":"https://github.com/alovajs/alovajs.github.io/blob/main/docs/tutorial/03-client/01-strategy/16-use-uploader.md","tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"title":"Unified upload strategy"},"sidebar":"tutorial","previous":{"title":"Server-Sent Events Request","permalink":"/tutorial/client/strategy/use-sse"},"next":{"title":"Update states across components","permalink":"/tutorial/client/in-depth/update-across-components"}}');var s=l(74848),t=l(28453),a=l(11470),r=l(19365);const d={title:"Unified upload strategy"},o=void 0,c={},p=[{value:"Features",id:"features",level:2},{value:"Usage",id:"usage",level:2},{value:"Basic usage",id:"basic-usage",level:3},{value:"Append uploading files",id:"append-uploading-files",level:3},{value:"Append a single File object",id:"append-a-single-file-object",level:4},{value:"Batch append file data in multiple formats",id:"batch-append-file-data-in-multiple-formats",level:4},{value:"Insert to the specified position",id:"insert-to-the-specified-position",level:4},{value:"Select file",id:"select-file",level:4},{value:"Trigger upload",id:"trigger-upload",level:3},{value:"Automatically upload all pending files",id:"automatically-upload-all-pending-files",level:4},{value:"Specify specific files to upload",id:"specify-specific-files-to-upload",level:4},{value:"Limit the number of files",id:"limit-the-number-of-files",level:3},{value:"Delete file items",id:"delete-file-items",level:3},{value:"Interrupt upload",id:"interrupt-upload",level:3},{value:"Upload file data",id:"upload-file-data",level:3},{value:"Batch upload",id:"batch-upload",level:3},{value:"Image preview",id:"image-preview",level:3},{value:"Customize file selection",id:"customize-file-selection",level:3},{value:"API",id:"api",level:2},{value:"Hook Configuration",id:"hook-configuration",level:3},{value:"Responsive data",id:"responsive-data",level:3},{value:"AlovaFileItem",id:"alovafileitem",level:4},{value:"Progress",id:"progress",level:4},{value:"Operation function",id:"operation-function",level:3},{value:"AlovaRawFile",id:"alovarawfile",level:4},{value:"FileAppendOptions",id:"fileappendoptions",level:4},{value:"Event",id:"event",level:3}];function h(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.admonition,{title:"strategy type",type:"info",children:[(0,s.jsx)(n.p,{children:"use hook"}),(0,s.jsx)(n.p,{children:"alova@3.3+"})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Before using extended hooks, make sure you are familiar with the basic use of alova."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Simple file upload, base64, file object, blob object, arraybuffer object, Canvas can be directly uploaded."}),"\n",(0,s.jsx)(n.p,{children:"Use scenarios include:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Only one upload button"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"The style of the upload component does not match"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"The upload data format is diverse"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Automatic conversion of multiple formats"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Support single file and batch upload"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Get the upload progress and total progress of each file"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Limit file format and size"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Automatic preview thumbnail"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.h3,{id:"basic-usage",children:"Basic usage"}),"\n",(0,s.jsxs)(a.A,{groupId:"framework",children:[(0,s.jsx)(r.A,{value:"1",label:"vue",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<template>\n  <button @click="handleUpload">Upload</button>\n  <div>Total progress: {{ progress.uploaded / progress.total * 100 }}</div>\n  <div>Success number: {{ successCount }}, failure number: {{ failCount }}</div>\n  <div v-for="fileItem in fileList">\n    <img :src="fileItem.src" />\n    <span v-if="fileItem.status === 1"\n      >Upload progress: {{ fileItem.progress.uploaded / fileItem.progress.total * 100 }}</span\n    >\n    <span v-else-if="fileItem.status === 3">{{ fileItem.error.message }}</span>\n  </div>\n</template>\n\n<script setup>\n  const {\n    // File data list, each item contains file name, file path, upload status, upload progress, for specific format, see "Upload file data"\n    fileList,\n\n    // The first file data item, generally used to upload a single file\n    file,\n\n    // Is it uploading\n    uploading,\n\n    // Upload error message\n    error,\n\n    // Number of successful uploads\n    successCount,\n\n    // Number of failed uploads\n    failCount,\n\n    // Total upload progress, including uploaded and total\n    progress,\n\n    // Add file data items, automatically converted to File objects after adding\n    appendFiles,\n\n    // Delete files\n    removeFiles,\n\n    // Trigger upload\n    upload,\n\n    // Cancel upload\n    abort,\n\n    // Each file upload success event\n    onSuccess,\n\n    // Each file upload failure event\n    onError,\n\n    // Each file upload completion event\n    onComplete\n  } = useUploader(({ file, name }) => uploadFile(file, name));\n\n  const handleUpload = async () => {\n    await appendFiles();\n    await upload();\n  };\n<\/script>\n'})})}),(0,s.jsx)(r.A,{value:"2",label:"react",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const App = () => {\n  const {\n    // File data list, each item contains file name, file path, upload status, upload progress, see the specific format below\n    fileList,\n\n    // The first file data item, generally used to upload a single file\n    file,\n\n    // Is it uploading\n    uploading,\n\n    // Upload error information\n    error,\n\n    // Number of successful uploads\n    successCount,\n\n    // Number of upload failures\n    failCount,\n\n    // Total upload progress, see the specific format below\n    progress,\n\n    // Add file data items, automatically converted to File objects after adding\n    appendFiles,\n\n    // Delete files\n    removeFiles,\n\n    // Trigger upload\n    upload,\n\n    // Cancel upload\n    abort,\n\n    // Each file upload success event\n    onSuccess,\n\n    // Each file upload failure event\n    onError,\n\n    // Each file upload completion event\n    onComplete\n  } = useUploader(({ file, name }) => uploadFile(file, name));\n  const handleUpload = async () => {\n    await appendFiles();\n    await upload();\n  };\n\n  return (\n    <>\n      <button onClick={handleUpload}>Upload</button>\n      <div>Total progress: {(progress.uploaded / progress.total) * 100}</div>\n      <div>\n        Number of successes: {successCount}, number of failures: {failCount}\n      </div>\n      {fileList.map(fileItem => (\n        <div>\n          <img src={fileItem.src} />\n          {fileItem.status === 1 ? (\n            <span>\n              Upload progress: {(fileItem.progress.uploaded / fileItem.progress.total) * 100}\n            </span>\n          ) : fileItem.status === 3 ? (\n            <span>{fileItem.error.message}</span>\n          ) : null}\n        </div>\n      ))}\n    </>\n  );\n};\n"})})}),(0,s.jsx)(r.A,{value:"3",label:"svelte",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<script>\n  const {\n    // File data list, each item contains file name, file path, upload status, upload progress, see the specific format below\n    fileList,\n\n    // The first file data item, generally used to upload a single file\n    file,\n\n    // Is it uploading\n    uploading,\n\n    // Upload error information\n    error,\n\n    // Number of successful uploads\n    successCount,\n\n    // Number of failed uploads\n    failCount,\n\n    // Total upload progress, see the specific format below\n    progress,\n\n    // Add file data items, automatically converted to File objects after adding\n    appendFiles,\n\n    // Delete files\n    removeFiles,\n\n    // Trigger upload\n    upload,\n\n    // Cancel upload\n    abort,\n\n    // Each file upload success event\n    onSuccess,\n\n    // Each file upload failure event\n    onError,\n\n    // Each file upload completion event\n    onComplete\n  } = useUploader(({ file, name }) => uploadFile(file, name));\n\n  const handleUpload = async () => {\n    await appendFiles();\n    await upload();\n  };\n<\/script>\n\n<button on:click="{handleUpload}">Upload</button>\n<div>Total progress: { $progress.uploaded / $progress.total * 100 }</div>\n<div>Success number: { $successCount }, failure number: { $failCount }</div>\n{#each $fileList as fileItem}\n<div>\n  <img src="{fileItem.src}" />\n  {#if fileItem.status === 1}\n  <span>Upload progress: { fileItem.progress.uploaded / fileItem.progress.total * 100 }</span>\n  {#else if fileItem.status === 3}\n  <span>{ fileItem.error.message }</span>\n  {/if}\n</div>\n{/each}\n'})})}),(0,s.jsx)(r.A,{value:"4",label:"solid",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const App = () => {\n  const {\n    // File data list, each item contains file name, file path, upload status, upload progress, see the specific format below\n    fileList,\n\n    // The first file data item, generally used to upload a single file\n    file,\n\n    // Is it uploading\n    uploading,\n\n    // Upload error information\n    error,\n\n    // Number of successful uploads\n    successCount,\n\n    // Number of failed uploads\n    failCount,\n\n    // Total upload progress, see the specific format below\n    progress,\n\n    // Add file data items, automatically converted to File objects after adding\n    appendFiles,\n\n    // Delete files\n    removeFiles,\n\n    // Trigger upload\n    upload,\n\n    // Cancel upload\n    abort,\n\n    // Each file upload success event\n    onSuccess,\n\n    // Each file upload failure event\n    onError,\n\n    // Each file upload completion event\n    onComplete\n  } = useUploader(({ file, name }) => uploadFile(file, name));\n  const handleUpload = async () => {\n    await appendFiles();\n    await upload();\n  };\n\n  return (\n    <>\n      <button onClick={handleUpload}>Upload</button>\n      <div>Total progress: {(progress().uploaded / progress().total) * 100}</div>\n      <div>\n        Number of successes: {successCount()}, number of failures: {failCount()}\n      </div>\n      <For each={fileList()}>\n        {fileItem => (\n          <div>\n            <img src={fileItem.src} />\n            {fileItem.status === 1 ? (\n              <span>\n                Upload progress: {(fileItem.progress.uploaded / fileItem.progress.total) * 100}\n              </span>\n            ) : fileItem.status === 3 ? (\n              <span>{fileItem.error.message}</span>\n            ) : null}\n          </div>\n        )}\n      </For>\n    </>\n  );\n};\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"append-uploading-files",children:"Append uploading files"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"appendFiles"})," allows you to append files to the upload list by passing in base64, File object, Blob, ArrayBuffer, HTMLCanvasElement data formats, and automatically convert them into a unified File object. The following demonstrates its usage through specific scenarios."]}),"\n",(0,s.jsx)(n.h4,{id:"append-a-single-file-object",children:"Append a single File object"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Create an object through new File, the name field is used to identify the file name\nconst file = {\n  file: new File(['file content'], 'report.pdf', { type: 'application/pdf' })\n};\n\n// Call appendFiles, if start is not passed, it will be appended to the end of the list by default\nconst appendCount = await appendFiles(file);\n"})}),"\n",(0,s.jsx)(n.h4,{id:"batch-append-file-data-in-multiple-formats",children:"Batch append file data in multiple formats"}),"\n",(0,s.jsx)(n.p,{children:"Append base64 images, Blob data and Canvas screenshots at the same time."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Base64 image (name and mimeType are required)\nconst base64File = {\n  file: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUg...',\n  name: 'chart.png', // defaults to image.png\n  mimeType: 'image/png' // defaults to the base64 data prefix\n};\n\n// Blob data (such as obtained from the clipboard)\nconst blob = new Blob(\n  [\n    JSON.stringify({\n      data: 'test'\n    })\n  ],\n  {\n    type: 'application/json'\n  }\n);\nconst blobFile = {\n  file: blob,\n  name: 'config.json', // defaults to file\n  mimeType: 'application/json' // defaults to blob.type\n};\n\n// Canvas\nconst canvas = document.querySelector('canvas');\nconst canvasFile = {\n  file: canvas,\n  name: 'screenshot.png', // defaults to image.png\n  mimeType: 'image/png' // defaults to blob.type\n};\n\n// Batch append files\nconst appendCount = await appendFiles([base64File, blobFile, canvasFile]);\n"})}),"\n",(0,s.jsx)(n.h4,{id:"insert-to-the-specified-position",children:"Insert to the specified position"}),"\n",(0,s.jsx)(n.p,{children:"Insert the newly uploaded file into the second position of the list."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Insert a CSV file\nconst insertFile = {\n  file: new File(['id,name\\n1,John'], 'data.csv', { type: 'text/csv' })\n};\n\n// Insert the file to position 2 (index starts at 0)\nconst appendCount = await appendFiles(insertFile, {\n  start: 2\n});\n"})}),"\n",(0,s.jsx)(n.h4,{id:"select-file",children:"Select file"}),"\n",(0,s.jsx)(n.p,{children:"When no file data is passed, the upload dialog box will be opened by default to select the file."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Append files through appendFiles\nconst appendCount = await appendFiles({\n  // Upload file type, this parameter will be set to the accept attribute of <input type="file">\n  // See [https://developer.mozilla.org/docs/Web/HTML/Reference/Elements/input/file#accept]\n  accept: \'png, jpg, jpeg\',\n\n  // Whether to allow multiple files to be selected, this parameter will be set to the multiple attribute of <input type="file">\n  // See [https://developer.mozilla.org/docs/Web/HTML/Element/input/file#multiple]\n  multiple: true,\n\n  // Insert to the start of the list\n  start: 0\n});\n'})}),"\n",(0,s.jsx)(n.h3,{id:"trigger-upload",children:"Trigger upload"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"upload"})," function is used to trigger the file upload process, supporting uploading all files or specified files."]}),"\n",(0,s.jsx)(n.h4,{id:"automatically-upload-all-pending-files",children:"Automatically upload all pending files"}),"\n",(0,s.jsx)(n.p,{children:'Upload all "not uploaded" or "failed to upload" files in the upload list.'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const response = await upload();\n"})}),"\n",(0,s.jsx)(n.h4,{id:"specify-specific-files-to-upload",children:"Specify specific files to upload"}),"\n",(0,s.jsx)(n.p,{children:"Re-upload the files with indexes 1 and 3. If there are files that have been successfully uploaded, an error will be reported."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const response = await upload(1, 3);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can also pass in the item specified in ",(0,s.jsx)(n.code,{children:"fileList"})," to upload"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const response = await upload(fileList[1], fileList[3]);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"limit-the-number-of-files",children:"Limit the number of files"}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"limit"})," to limit the number of uploaded files. The default is unlimited."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"useUploader(({ file, name }) => uploadFile(file, name), {\n  // Limit uploaded files\n  limit: 3\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"delete-file-items",children:"Delete file items"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"removeFiles"})," function can be used to delete file items in the upload list. The items being uploaded will be interrupted."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Delete all items\nremoveFiles();\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Delete items with index 0 and 2\nremoveFiles(0, 2);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can also pass in the items specified in ",(0,s.jsx)(n.code,{children:"fileList"})," to delete"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"removeFiles(fileList[1], fileList[3]);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"interrupt-upload",children:"Interrupt upload"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"abort"})," function can be used to interrupt the upload of file items in the list."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Abort all items being uploaded\nabort();\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Abort items with indexes 0 and 2\nabort(0, 2);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can also pass in the item specified in ",(0,s.jsx)(n.code,{children:"fileList"})," to abort"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"abort(fileList[1], fileList[3]);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"upload-file-data",children:"Upload file data"}),"\n",(0,s.jsxs)(n.p,{children:["When a file is added to the upload list via ",(0,s.jsx)(n.code,{children:"appendFiles"}),", ",(0,s.jsx)(n.code,{children:"fileList"})," and ",(0,s.jsx)(n.code,{children:"file"})," will be updated, which contains relevant information about the uploaded file."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const {\n  // Type is File[]\n  fileList,\n\n  // Type is File\n  file\n} = useUploader(({ file, name }) => uploadFile(file, name));\n"})}),"\n",(0,s.jsx)(n.p,{children:"The information they contain is as follows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"interface File {\n  // Temporary path or file path after successful upload, not image\n  src?: string;\n\n  // File object\n  file: File;\n\n  // 0 means not uploaded, 1 means uploading, 2 means completed, 3 means upload error\n  status: 0 | 1 | 2 | 3;\n\n  // Error object, when uploading error, error object needs to be assigned\n  error?: Error;\n\n  // Upload progress information\n  progress: {\n    uploaded: number;\n    total: number;\n  };\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"batch-upload",children:"Batch upload"}),"\n",(0,s.jsxs)(n.p,{children:["By default, when calling ",(0,s.jsx)(n.code,{children:"upload"})," to upload multiple files, the request handler function will be called in a loop, which is usually convenient when the interface only supports single file upload. But when the interface supports batch upload, you can enable batch upload by setting ",(0,s.jsx)(n.code,{children:"mode"})," to ",(0,s.jsx)(n.code,{children:"batch"}),". At this time, the request handler function will only be called once and get the array parameter."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"useUploader(fileList => batchUpload(fileList), {\n  mode: 'batch'\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"image-preview",children:"Image preview"}),"\n",(0,s.jsxs)(n.p,{children:["When uploading images and want to preview them, you can set ",(0,s.jsx)(n.code,{children:"localLink"})," and ",(0,s.jsx)(n.code,{children:"replaceSrc"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"useUploader(({ file, name }) => uploadFile(file, name), {\n  // Generate a temporary image path, which can be used to display the image content before the image is uploaded. The default value is false\n  localLink: true,\n\n  // When the upload is successful, the src field in the fileList item can be automatically replaced with the file address on the server. It is often used when uploading images\n  // data is the response data. This function returns the file address on the server\n  // If this function is not specified, there will be no replacement behavior\n  // index is the image index, which is often used when mode is `batch`\n  replaceSrc: (data, index) => data.imgPath\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"customize-file-selection",children:"Customize file selection"}),"\n",(0,s.jsxs)(n.p,{children:["As mentioned in ",(0,s.jsx)(n.code,{children:"appendFile"}),", if ",(0,s.jsx)(n.code,{children:"files"})," is not passed in, a dialog box will be opened to select the file. This default is valid on the browser side. When you use this request strategy in a non-browser environment, you can customize the file selection."]}),"\n",(0,s.jsx)(n.p,{children:"The following is an example of selecting an image in react-native."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"useUploader.selectFile = async fileAppendOptions => {\n  const { status } = await Permissions.askAsync(Permissions.CAMERA_ROLL);\n  if (status !== 'granted') {\n    throw new Error('Camera roll permission not granted');\n  }\n\n  const result = await ImagePicker.launchImageLibraryAsync({\n    mediaTypes: ImagePicker.MediaTypeOptions.Images,\n    allowsEditing: true,\n    aspect: [4, 3],\n    quality: 1\n  });\n\n  if (result.didCancel) {\n    throw new Error('user canceled');\n  }\n\n  return result.assets.map(({ uri, type, name }) => ({\n    file: uri,\n    name: name || 'image.png',\n    mimeType: type || 'image/png'\n  }));\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,s.jsx)(n.h3,{id:"hook-configuration",children:"Hook Configuration"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"limit"}),(0,s.jsx)(n.td,{children:"Limit the number of uploads"}),(0,s.jsx)(n.td,{children:"number"}),(0,s.jsx)(n.td,{children:"-"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"localLink"}),(0,s.jsx)(n.td,{children:"Whether to generate a local preview URL"}),(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:"false"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"replaceSrc"}),(0,s.jsx)(n.td,{children:"Replace the file path with the response data"}),(0,s.jsx)(n.td,{children:"(response: any, index: number) => string"}),(0,s.jsx)(n.td,{children:"-"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"mode"}),(0,s.jsx)(n.td,{children:"Upload mode, single upload or batch upload"}),(0,s.jsx)(n.td,{children:"'each' | 'batch'"}),(0,s.jsx)(n.td,{children:"'each'"}),(0,s.jsx)(n.td,{children:"3.3.0"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"responsive-data",children:"Responsive data"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"fileList"}),(0,s.jsx)(n.td,{children:"A list of file data, each item contains the file name, file path, upload status, and upload progress"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.a,{href:"#alovafileitem",children:"AlovaFileItem"}),"[]"]}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"file"}),(0,s.jsx)(n.td,{children:"The first file data item, generally used to upload a single file"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.a,{href:"#alovafileitem",children:"AlovaFileItem"})," | undefined"]}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"uploading"}),(0,s.jsx)(n.td,{children:"Is uploading in progress"}),(0,s.jsx)(n.td,{children:"boolean"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"error"}),(0,s.jsx)(n.td,{children:"Upload error message"}),(0,s.jsx)(n.td,{children:"Error | undefined"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"progress"}),(0,s.jsx)(n.td,{children:"Total upload progress, including uploaded and total"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"#progress",children:"Progress"})}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"successCount"}),(0,s.jsx)(n.td,{children:"Number of successful uploads"}),(0,s.jsx)(n.td,{children:"number"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"failCount"}),(0,s.jsx)(n.td,{children:"Number of failed uploads"}),(0,s.jsx)(n.td,{children:"number"}),(0,s.jsx)(n.td,{children:"3.3.0"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"alovafileitem",children:"AlovaFileItem"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"file"}),(0,s.jsx)(n.td,{children:"File object"}),(0,s.jsx)(n.td,{children:"File"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"src"}),(0,s.jsx)(n.td,{children:"File preview src"}),(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"error"}),(0,s.jsx)(n.td,{children:"Error object, with value when upload fails"}),(0,s.jsx)(n.td,{children:"Error | undefined"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"status"}),(0,s.jsx)(n.td,{children:"0 means not uploaded, 1 means uploading, 2 means completed, 3 means upload error"}),(0,s.jsx)(n.td,{children:"0 | 1 | 2 | 3"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"progress"}),(0,s.jsx)(n.td,{children:"Current file upload progress"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"#progress",children:"Progress"})}),(0,s.jsx)(n.td,{children:"3.3.0"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"progress",children:"Progress"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"uploaded"}),(0,s.jsx)(n.td,{children:"Number of uploaded files"}),(0,s.jsx)(n.td,{children:"number"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"total"}),(0,s.jsx)(n.td,{children:"Total"}),(0,s.jsx)(n.td,{children:"number"}),(0,s.jsx)(n.td,{children:"3.3.0"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"operation-function",children:"Operation function"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Function parameter"}),(0,s.jsx)(n.th,{children:"Return value"}),(0,s.jsx)(n.th,{children:"Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"appendFiles"}),(0,s.jsx)(n.td,{children:"Add file data item, automatically converted to File object after adding"}),(0,s.jsxs)(n.td,{children:["file: ",(0,s.jsx)(n.a,{href:"#alovarawfile",children:"AlovaRawFile"})," | ",(0,s.jsx)(n.a,{href:"#alovarawfile",children:"AlovaRawFile"}),"[], options?: ",(0,s.jsx)(n.a,{href:"#fileappendoptions",children:"FileAppendOptions"})]}),(0,s.jsx)(n.td,{children:"Promise<number>"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"upload"}),(0,s.jsx)(n.td,{children:"Upload file"}),(0,s.jsxs)(n.td,{children:["...positions: Array<",(0,s.jsx)(n.a,{href:"#alovafileitem",children:"AlovaFileItem"})," | number>"]}),(0,s.jsx)(n.td,{children:"Promise<Response>"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"removeFiles"}),(0,s.jsx)(n.td,{children:"Delete file data item"}),(0,s.jsxs)(n.td,{children:["...positions: Array<",(0,s.jsx)(n.a,{href:"#alovafileitem",children:"AlovaFileItem"})," | number>"]}),(0,s.jsx)(n.td,{children:"void"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"abort"}),(0,s.jsx)(n.td,{children:"Abort file upload"}),(0,s.jsxs)(n.td,{children:["...positions: Array<",(0,s.jsx)(n.a,{href:"#alovafileitem",children:"AlovaFileItem"})," | number>"]}),(0,s.jsx)(n.td,{children:"void"}),(0,s.jsx)(n.td,{children:"3.3.0"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"alovarawfile",children:"AlovaRawFile"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"file"}),(0,s.jsx)(n.td,{children:"File object, base64, Blob, File, ArrayBuffer or HTMLCanvasElement"}),(0,s.jsx)(n.td,{children:"File | string | Blob | ArrayBuffer | HTMLCanvasElement"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"src"}),(0,s.jsx)(n.td,{children:"File preview src"}),(0,s.jsx)(n.td,{children:"string?"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"name"}),(0,s.jsx)(n.td,{children:"File name"}),(0,s.jsx)(n.td,{children:"string?"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"mimeType"}),(0,s.jsx)(n.td,{children:"File mimeType"}),(0,s.jsx)(n.td,{children:"string?"}),(0,s.jsx)(n.td,{children:"3.3.0"})]})]})]}),"\n",(0,s.jsx)(n.h4,{id:"fileappendoptions",children:"FileAppendOptions"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"start"}),(0,s.jsx)(n.td,{children:"Insert position"}),(0,s.jsx)(n.td,{children:"number?"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"multiple"}),(0,s.jsx)(n.td,{children:"Whether multiple selection is allowed, valid in file dialog box"}),(0,s.jsx)(n.td,{children:"boolean?"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"accept"}),(0,s.jsx)(n.td,{children:"Selectable file suffix, valid in file dialog box"}),(0,s.jsx)(n.td,{children:"string?"}),(0,s.jsx)(n.td,{children:"3.3.0"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"event",children:"Event"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Name"}),(0,s.jsx)(n.th,{children:"Description"}),(0,s.jsx)(n.th,{children:"Callback parameter"}),(0,s.jsx)(n.th,{children:"Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"onSuccess"}),(0,s.jsx)(n.td,{children:"Upload success event"}),(0,s.jsx)(n.td,{children:"event"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"onError"}),(0,s.jsx)(n.td,{children:"Upload failure event"}),(0,s.jsx)(n.td,{children:"event"}),(0,s.jsx)(n.td,{children:"3.3.0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"onComplete"}),(0,s.jsx)(n.td,{children:"Upload completion event"}),(0,s.jsx)(n.td,{children:"event"}),(0,s.jsx)(n.td,{children:"3.3.0"})]})]})]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);