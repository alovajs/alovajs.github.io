"use strict";(globalThis.webpackChunkalova_website=globalThis.webpackChunkalova_website||[]).push([[611],{21247(e,t,a){a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"tutorial/best-practice/middleware","title":"Common middleware practices","description":"Delay update loading","source":"@site/versioned_docs/version-v2/tutorial/07-best-practice/05-middleware.md","sourceDirName":"tutorial/07-best-practice","slug":"/tutorial/best-practice/middleware","permalink":"/v2/tutorial/best-practice/middleware","draft":false,"unlisted":false,"editUrl":"https://github.com/alovajs/alovajs.github.io/blob/main/versioned_docs/version-v2/tutorial/07-best-practice/05-middleware.md","tags":[],"version":"v2","sidebarPosition":5,"frontMatter":{"title":"Common middleware practices"},"sidebar":"tutorial","previous":{"title":"Multiple servers","permalink":"/v2/tutorial/best-practice/multiple-servers"},"next":{"title":"Request adapter","permalink":"/v2/category/request-adapter"}}');var n=a(74848),o=a(28453);const r={title:"Common middleware practices"},s=void 0,l={},d=[{value:"Delay update loading",id:"delay-update-loading",level:2}];function c(e){const t={code:"code",h2:"h2",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"delay-update-loading",children:"Delay update loading"}),"\n",(0,n.jsx)(t.p,{children:"When the response is very fast, the loading status will flash once, which will bring a bad experience to the user. Delaying the loading update can make the loading status display after a period of time. If the response is completed within this period, it will not appear. Loading status. Let's implement a middleware with delayed update loading."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-javascript",children:"const delayLoadingMiddleware =\n  (delayTimer = 1000) =>\n  async (ctx, next) => {\n    //Control loading by yourself\n    ctx.controlLoading();\n\n    //Delay updates for a specific time\n    const timer = setTimeout(() => {\n      ctx.update({ loading: true });\n    }, delayTimer);\n    await next();\n    ctx.update({ loading: false });\n    clearTimeout(timer);\n  };\n\nuseRequest(methodInstance, {\n  middleware: delayLoadingMiddleware()\n});\n"})})]})}function p(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},28453(e,t,a){a.d(t,{R:()=>r,x:()=>s});var i=a(96540);const n={},o=i.createContext(n);function r(e){const t=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);