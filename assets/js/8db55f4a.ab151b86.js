"use strict";(globalThis.webpackChunkalova_website=globalThis.webpackChunkalova_website||[]).push([[2184],{28453(e,t,a){a.d(t,{R:()=>o,x:()=>l});var i=a(96540);const n={},r=i.createContext(n);function o(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),i.createElement(r.Provider,{value:t},e.children)}},31586(e,t,a){a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"tutorial/project/best-practice/middleware","title":"Common middleware practices","description":"Delay update loading","source":"@site/docs/tutorial/07-project/01-best-practice/06-middleware.md","sourceDirName":"tutorial/07-project/01-best-practice","slug":"/tutorial/project/best-practice/middleware","permalink":"/tutorial/project/best-practice/middleware","draft":false,"unlisted":false,"editUrl":"https://github.com/alovajs/alovajs.github.io/blob/main/docs/tutorial/07-project/01-best-practice/06-middleware.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Common middleware practices"},"sidebar":"tutorial","previous":{"title":"Multiple servers","permalink":"/tutorial/project/best-practice/multiple-servers"},"next":{"title":"Parallel Request","permalink":"/tutorial/project/best-practice/parallel-request"}}');var n=a(74848),r=a(28453);const o={title:"Common middleware practices"},l=void 0,s={},d=[{value:"Delay update loading",id:"delay-update-loading",level:2}];function c(e){const t={code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"delay-update-loading",children:"Delay update loading"}),"\n",(0,n.jsx)(t.p,{children:"When the response is very fast, the loading status will flash once, which will bring a bad experience to the user. Delaying the loading update can make the loading status display after a period of time. If the response is completed within this period, it will not appear. Loading status. Let's implement a middleware with delayed update loading."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-javascript",children:"const delayLoadingMiddleware =\n  (delayTimer = 1000) =>\n  async (ctx, next) => {\n    const { loading } = ctx.proxyStates;\n\n    // Control loading by yourself\n    ctx.controlLoading();\n\n    // Delay updates for a specific time\n    const timer = setTimeout(() => {\n      loading.v = true;\n    }, delayTimer);\n    await next();\n    loading.v = false;\n    clearTimeout(timer);\n  };\n\nuseRequest(methodInstance, {\n  middleware: delayLoadingMiddleware()\n});\n"})})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}}}]);